---
// Modern M3 + Enhanced Glass Morphism ToTop Button
---

<button id="to-top" class="to-top-btn" aria-label="回到顶部" type="button">
  <svg class="to-top-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M7.41 15.41L12 10.83L16.59 15.41L18 14L12 8L6 14L7.41 15.41Z" fill="currentColor"
    ></path>
  </svg>
</button>

<script>
  import { initToTop } from '../scripts/to-top';

  // 监听 Astro 页面加载事件，以支持客户端导航
  document.addEventListener('astro:page-load', initToTop);
</script>

<style>
  /* 按钮主体 */
  .to-top-btn {
    /* 定位和层级 */
    position: fixed;
    bottom: 32px;
    right: 32px;
    z-index: 1000;

    /* M3 FAB 尺寸 */
    width: 56px;
    height: 56px;

    /* 重置默认样式 */
    padding: 0;
    margin: 0;
    border: none;
    cursor: pointer;
    outline: none;

    /* M3 形状 */
    border-radius: var(--md-sys-shape-corner-large);

    /* M3 颜色系统 */
    background-color: rgb(var(--md-sys-color-primary));
    color: rgb(var(--md-sys-color-on-primary));

    /* M3 阴影系统 */
    box-shadow: var(--md-sys-elevation-level3);

    /* 布局 */
    display: flex;
    align-items: center;
    justify-content: center;

    /* 初始状态：隐藏 */
    opacity: 0;
    transform: scale(0);
    pointer-events: none;

    /* 性能优化 */
    will-change: transform, opacity;

    /* M3 过渡动画 */
    transition:
      opacity var(--md-sys-motion-duration-theme) var(--md-sys-motion-easing-emphasized),
      transform var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized),
      background-color var(--md-sys-motion-duration-theme) var(--md-sys-motion-easing-standard),
      box-shadow var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
  }

  /* 显示状态 */
  .to-top-btn.show {
    opacity: 1;
    transform: scale(1);
    pointer-events: auto;
  }

  /* M3 悬停状态 */
  .to-top-btn:hover {
    background-color: rgb(var(--md-sys-color-primary-container));
    color: rgb(var(--md-sys-color-on-primary-container));
    box-shadow: var(--md-sys-elevation-level4);
    transform: scale(1.05);
  }

  /* M3 点击状态 */
  .to-top-btn:active {
    background-color: rgb(var(--md-sys-color-primary));
    color: rgb(var(--md-sys-color-on-primary));
    box-shadow: var(--md-sys-elevation-level1);
    transform: scale(0.95);
  }

  /* M3 焦点状态 */
  .to-top-btn:focus-visible {
    outline: 2px solid rgb(var(--md-sys-color-primary));
    outline-offset: 2px;
  }

  /* M3 图标样式 */
  .to-top-icon {
    width: 24px;
    height: 24px;
    color: inherit;
    transition: transform var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
  }

  /* 悬停时图标动画 */
  .to-top-btn:hover .to-top-icon {
    transform: translateY(-1px);
  }

  /* 响应式设计 */
  @media (max-width: 768px) {
    .to-top-btn {
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
    }

    .to-top-icon {
      width: 24px;
      height: 24px;
    }
  }

  @media (max-width: 480px) {
    .to-top-btn {
      bottom: 20px;
      right: 20px;
      width: 52px;
      height: 52px;
    }

    .to-top-icon {
      width: 22px;
      height: 22px;
    }
  }

  /* 无障碍适配 */
  @media (prefers-reduced-motion: reduce) {
    .to-top-btn,
    .to-top-icon {
      transition: none !important;
      animation: none !important;
    }

    .to-top-btn:hover {
      transform: scale(1) !important;
    }

    .to-top-btn:hover .to-top-icon {
      transform: none !important;
    }
  }

  /* 高对比度模式 */
  @media (prefers-contrast: high) {
    .to-top-btn {
      background-color: rgb(var(--md-sys-color-primary)) !important;
      border: 2px solid rgb(var(--md-sys-color-outline)) !important;
    }
  }

  /* 打印样式 */
  @media print {
    .to-top-btn {
      display: none !important;
    }
  }
</style>
